<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>FoodSense - Register</title>
	<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-cover bg-center" style="background-image:url('https://images.unsplash.com/photo-1613478223719-2ab802602423?q=80&w=1600&auto=format&fit=crop');">
	<div class="min-h-screen flex items-center justify-center p-4">
		<div class="w-full max-w-md bg-white/90 backdrop-blur rounded-2xl shadow p-6">
			<h1 class="text-2xl font-bold text-center mb-1 text-rose-700">Join FoodSense</h1>
			<form id="form" class="space-y-4 mt-4">
				<input id="name" class="w-full border rounded px-3 py-2" type="text" placeholder="Full name" />
				<input id="email" class="w-full border rounded px-3 py-2" type="email" placeholder="Email" required />
				<input id="password" class="w-full border rounded px-3 py-2" type="password" placeholder="Password" required />
				<div id="error" class="text-red-600 text-sm"></div>
				<button class="w-full bg-rose-600 hover:bg-rose-700 text-white rounded px-3 py-2" type="submit">Create account</button>
			</form>
			<p class="text-sm text-center mt-4">Already have an account? <a href="./signin.html" class="text-rose-700 font-medium">Sign in</a></p>
		</div>
	</div>
	<script>
		const API_BASE = (localStorage.getItem('VITE_API_BASE') || 'http://localhost:8000');
		document.getElementById('form').addEventListener('submit', async (e) => {
			e.preventDefault();
			const full_name = (document.getElementById('name')).value;
			const email = (document.getElementById('email')).value;
			const password = (document.getElementById('password')).value;
			try {
				const res = await fetch(API_BASE + '/api/auth/register', {
					method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ full_name, email, password })
				});
				if (!res.ok) throw new Error((await res.json()).detail || 'Registration failed');
				// auto login
				const res2 = await fetch(API_BASE + '/api/auth/login', {
					method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email, password })
				});
				const data = await res2.json();
				localStorage.setItem('token', data.access_token);
				location.href = './dashboard.html';
			} catch (err) {
				document.getElementById('error').textContent = err.message || 'Registration failed';
			}
		});
	</script>
</body>
</html>

